<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Forged by Fire Strategy TTRPG Character Sheet</title>

	<!-- This needs to be compiled to load the style. -->
	<script type="text/javascript" src="./src/js/common.js"></script>

	<!-- Dynamically load the style set by the user. -->
	<link id="theme-link" rel="stylesheet" />
	<script type="text/javascript">Theme.set()</script>
	<link href="./src/css/style.css" rel="stylesheet" />

	<!-- Load the rest of the scripts. Ordered to statisfy dependancies -->
	<script type="text/javascript" src="./definitions.js"></script>
	<script type="text/javascript" src="./src/js/widget/notebook.js"></script>
	<script type="text/javascript" src="./src/js/widget/category.js"></script>
	<script type="text/javascript" src="./src/js/widget/tagger.js"></script>
	<script type="text/javascript" src="./src/js/presetter.js"> </script>
	<script type="text/javascript" src="./src/js/pointbuy.js"></script>
	<script type="text/javascript" src="./src/js/widget/buildables.js"></script>
	<script type="text/javascript" src="./src/js/model/battalion.js"></script>
	<script type="text/javascript" src="./src/js/model/character.js"></script>
	<script type="text/javascript" src="./src/js/model/item.js"></script>
	<script type="text/javascript" src="./src/js/model/stats.js"></script>
	<script type="text/javascript" src="./src/js/model/check.js"></script>
	<script type="text/javascript" src="./src/js/model/skill.js"></script>
	<script type="text/javascript" src="./src/js/model/inventory.js"></script>
	<script type="text/javascript" src="./src/js/macro_builder.js"></script>
	<script type="text/javascript" src="./src/js/lang/calculator.js"></script>
	<script type="text/javascript" src="./src/js/lang/polish.js"></script>
	<script type="text/javascript" src="./src/js/lang/markup.js"></script>
	<script type="text/javascript" src="./src/js/context/reminder.js"></script>
	<script type="text/javascript" src="./src/js/context/requirements.js"></script>
	<script type="text/javascript" src="./src/js/context/compatible.js"></script>
	<script type="text/javascript" src="./src/js/feature.js"></script>
	<script type="text/javascript" src="./src/js/widget/dynamic.js"></script>
	<script type="text/javascript" src="./src/js/legacy.js"></script>
	<script type="text/javascript" src="./src/js/sheet.js"> </script>

</head>
<body class="base">

	<!-- This is the main body of the application -->
	<script type="text/javascript">

		let   sheet = undefined;
		const body  = document.getElementsByTagName("body")[0];

		// create and add the actual sheet dynamically
		try {

			// in case we manually launched the session editor
			SessionEditor.checkLaunch();
			
			// if we reach this point we want the normal sheet
			sheet = new Sheet(definitions);
			body.appendChild(sheet.root);

			// Show a "Leave site?" dialog
			window.onbeforeunload = (() => {
				sheet.macros.historySave();
				return true;
			});
		} catch (error) {
			const editor = new SessionEditor("v2session")
			body.appendChild(editor.root);
			throw error;
		}

	</script>

	<noscript>This webpage needs javascript to run.</noscript>
</body>
</html>