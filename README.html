<h1>Character Creator for a Collaborative Fire Emblem: Three Houses TTRPG</h1>
<h2>About</h2>
<p>This webapp serves as a character creator and virtual character sheet for a collaborative homebrew TTRPG based on Fire Emblem: Three Houses, originally started by Bradley B but now run by MiasmaToast.</p>
<h2>Building</h2>
<p>Currently, a javascript file for the definition data must be generated by running <a href="https://github.com/struct-rgb/feth_ttrpg_character_sheet/blob/main/build.py">this python script</a>. The builder can then be used by opening <a href="https://github.com/struct-rgb/feth_ttrpg_character_sheet/blob/main/index.html">index.html</a> in a web browser, no internet connection needed.</p>
<h2>Changelog</h2>
<h3>Version 4.1.2</h3>
<ul>
<li>Fixed issue parsing <code>Required</code> predicate in feature requirements</li>
</ul>
<h3>Version 4.1.0</h3>
<ul>
<li>Added the Morph skill properly, as well as Shifter variants and Morph D arts</li>
</ul>
<h3>Version 4.0.0</h3>
<h4>General</h4>
<ul>
<li>Reorganized the layout of the Create &gt; Character tab</li>
<li>Added a select in Create &gt; Character for combat initiative</li>
<li>Added a display to show how many skill points are available</li>
<li>Implemented new weapon triangle Mt bonus into damage formula</li>
<li>Fixed equip check bug with Rank C-B arts when max rank is &lt; B.</li>
</ul>
<h4>Game Data</h4>
<ul>
<li>Combined breaker and breaker+ abilities into modal abilities </li>
<li>Combined prowess abilities into modal abilities</li>
<li>Updated descriptions, stats, and growths for basic classes</li>
<li>Small might rebalances on various Swords and Axes</li>
<li>Bow can counter at Range 1, but now give a small Avo penalty</li>
<li>Added in spells and arts for the new Guile healer toolkit</li>
<li>Added in reworked reason spells with elemental attributes</li>
<li>Many fixes for data errors discovered using build script improvements</li>
<li>Updated all game data to use new markup style in their descriptions</li>
<li>Set status of FE:3H setting specific features to hidden</li>
</ul>
<h4>Markup</h4>
<ul>
<li>Markup syntax was changed to use <code>}{</code> as a field delimiter instead of <code>:</code></li>
<li>The empty center field was replaced with an optional third field</li>
<li>Leading <code>@</code> can be replaced with <code>#</code> to silence reminders in textual output</li>
</ul>
<h4>Calculator</h4>
<ul>
<li>Added new <code>let</code> expression which is used to create local variables</li>
<li>Replaced more and less expressions with max and min expressions</li>
<li>Begun work on a <code>match</code> expression to cleanly map values</li>
</ul>
<h4>Internal</h4>
<ul>
<li>Removed mounts as a pseudo feature; now they&#39;re just a mov modifier</li>
<li>Removed &quot;bowhit&quot; template from before general universal penalty</li>
<li>Rewrote the build script in nodejs to perform much more data validation</li>
</ul>
<h3>Version 3.7.0</h3>
<ul>
<li>NPC generator can now create Authority units with battalions.</li>
<li>Token generator is now able to generate tokens for battalions.</li>
<li>Sheet and rangefinder now supports larger unit sizes (2x2, 3x3, etc...)</li>
<li>Added option to export characters as VTT Enhancement Suite character files (buggy).</li>
<li>Added the option to generate HTML blurbs vs the traditional Markdown ones.</li>
<li>Add arts equipping validation to the arts section of the sheet (buggy).</li>
<li>Added mone content from Patch #6.</li>
</ul>
<h4>TODO</h4>
<ul>
<li>Add slots display to Abilities/Inventory/Arts</li>
<li>Incorperate equipment content into items.</li>
<li>Add skill checks &amp; macros under Assign &gt; Checks.</li>
<li>Add monster classes and presets.</li>
<li>Add an Assign &gt; Support tab.</li>
<li>Fix definitions so Ranks are an array.</li>
</ul>
<h3>Version 3.6.0</h3>
<ul>
<li>Added token generator to the Tools &gt; NPC tab.</li>
<li>Added interactive Range and AoE displays to some Items, Arts, and Gambits.</li>
<li>Added Metal, Water, and Beast elements to arts filter.</li>
<li>Added Half-slots to abilities and arts filters.</li>
<li>(Some) requirement indicators now update automatically.</li>
<li>Dynamically computed modifiers now update automatically.</li>
<li>Overhauled how stats update when changed.</li>
</ul>
<h4>Calculator</h4>
<ul>
<li>Added line comments in the form of <code>// comment</code></li>
<li>The <code>else</code> keword can optionally be followed with <code>then</code> in conditionals.</li>
</ul>
<h4>Game Data Changes</h4>
<ul>
<li>Rebuke rebalanced to remove bonus damage and only apply on hit after combat.</li>
<li>Lead by Example split up into Lead by Example 1 and Lead by Example 2.</li>
<li>Added Discipline Master (this was hard to implement, lol)</li>
<li>Added Lifedrinker (with explainer text for &#39;effect damage&#39;)</li>
<li>Lots of minor bug fixes and corrections.</li>
</ul>
<h3>Bug Fixes</h3>
<ul>
<li>NPC generation crashed if it put &gt;100 skill points in a Talent skill</li>
</ul>
<h3>Version 3.5.0</h3>
<h3>Improvements</h3>
<ul>
<li>Brawl weapons without Might or Mystic notify user on batch macrogen</li>
<li>Overhauled Range Penalty Calculation to prompt user for the attack range.</li>
<li>You can make it always prompt even with no penalty if you want to do that.</li>
<li>Includes prompt options for Close Counter and Far Counter.</li>
<li>Made it possible to import/export character, item, and battalion lists.</li>
<li>Stat change animation no longer plays when transfering stats to main sheet.</li>
</ul>
<h4>Bugfixes</h4>
<ul>
<li>Fixed bug with Combat Artist, Metamagician, and Trapper that crashes page</li>
<li>Fixed bug where Other skills doesn&#39;t take into account base skill aptitude</li>
<li>Arc Generation now correctly counts as a lightning metamagic</li>
<li>You can not import the same file more than once in a row.</li>
</ul>
<h4>Game Data Rebalances and Changes</h4>
<ul>
<li>Added new Tremor (Guile B) and Omen (Guile B)spells for playtest</li>
<li>Added new Solidarity (Faith C) and Perdition (Faith B) spells for playtest</li>
<li>Brutal&#39;s effect was reworked to apply in-combat conditions.</li>
<li>Big Dipper Strike given SP Cost +3 and it doens&#39;t apply [Rattled] now.</li>
<li>Bloodthirsty unequip effect updated to last while unit is Berserk</li>
<li>Flexible Blade nerfed to Mt +3 and Prot/Resl +3</li>
<li>Blizzard given Mt +1 and Hit +5</li>
<li>Cutting Gale given Mt -2 and Crit -5</li>
<li>Frostbite given Mt +2 and Crit +5</li>
<li>Mire given Hit +10</li>
<li>Pugni given Hit -5</li>
<li>Static Shock given Mt -1</li>
<li>Swarm given Mt +2, Hit +10, and TP Cost -1</li>
<li>Thunder given Crit +5</li>
<li>Wind given Mt -1</li>
</ul>
<h3>Version 3.4.0</h3>
<h4>Character Options</h4>
<ul>
<li>Added playtesting versions of Brad&#39;s new shield weapons.</li>
<li>Added in automatically calculated &quot;Other&quot; skill to the skills UI.</li>
<li>Fist Techniques now have prices associate with them.</li>
</ul>
<h4>Internal Changes</h4>
<ul>
<li>Added in dedicated shortcircuit &#39;and&#39; and &#39;or&#39; logical operators.</li>
<li>Other Prowess can now just be equipped without consuming an ability slot.</li>
<li>Logical and Relative expressions are now supported in arbitrary expressions.</li>
<li>This does not mean you <em>should use them</em> outside of conditional expressions.</li>
<li>Normal &quot;if&quot; conditional expressions still work the same because roll20.</li>
<li>Both &quot;metaif&quot; and &quot;bothif&quot; conditionals branch off of zero/non-zero values.</li>
<li>The &quot;when&quot; template has been removed; use &quot;bothif&quot; conditionals instead.</li>
</ul>
<h3>Version 3.3.0</h3>
<h4>Game Data</h4>
<ul>
<li>Training weapons now grant Crit -15 to curb crit stacking.</li>
<li>The names of the Banneret and Lord classes were swapped.</li>
<li>HP +5 now does not become a half slot at level 10.</li>
<li>Structure: Crossbow now only adds Mt +2</li>
<li>Addition of Rank E spells for Faith, Reason, and Guile</li>
<li>The Inevitable and Prolonged combat arts were rebalanced.</li>
</ul>
<h4>Changes to Abilities and Arts</h4>
<ul>
<li>&quot;Class&quot; and &quot;Equipped&quot; tabs were merged for both abilities and arts.</li>
<li>Optional class features are chosen instead of always listing each option.</li>
<li>Tactical arts can now now serve as hosts for combat arts.</li>
<li>Tactical arts no longer secretly use the equipped weapon as a host.</li>
<li>Combat arts that can be &quot;used with one other&quot; now actually can be.</li>
<li>Whether descriptions are collapsed is now preserved in the save data.</li>
<li>Batch Create Macros has been updated to incorporate these changes to arts.</li>
</ul>
<h4>Miscellaneous</h4>
<ul>
<li>Decreased load times for changing characters and inventory items.</li>
<li>Decreased time it takes to batch generate macros (above fix helped).</li>
<li>Attribute descriptions are included in generated macros when relevant.</li>
<li>Budding talent now only gives double gains after the bud threshold.</li>
<li>Budding talent threshold is now 16 (or 10 for a budding weakness).</li>
<li>Using a build preset to create a custom character now fills the point buy.</li>
<li>Added better filter popup options for character build selects.</li>
<li>Theme loads earlier so as not to flash grenade dark mode users.</li>
<li>Pointbuy shows amount that a change increases/decreases final stats.</li>
<li>Pointbuy allows you to configure these to play as an animation.</li>
<li>Added new &quot;Hacker&quot; theme (Boneless mode but green).</li>
<li>Changed skills aptitude from numerical to user friendly word based select.</li>
<li>Various minor bugfixes.</li>
</ul>
<h4>Internal Changes</h4>
<ul>
<li>Enshrined &quot;bothif&quot; as a full and proper calculator conditional construct.</li>
<li>Old &quot;bothif&quot; template has been renamed to &quot;when&quot; now but should be avoided.</li>
<li>Most references to &quot;weapon&quot; internally have been changed to &quot;item&quot;.</li>
<li>Better legacy support for importing items and battalions.</li>
</ul>
<h3>Version 3.2.0</h3>
<ul>
<li>Various Patch #6 features added</li>
<li>Range Penalty updated to apply to all skill types when pas weapon range</li>
</ul>
<h3>Version 3.1.0</h3>
<ul>
<li>Brawl NPC presets now include Rank D combat arts.</li>
<li>Brawl NPC presets now use fewer but better fist techniques.</li>
<li>Brawl NPC presets now have default Mighty/Mystic attributes.</li>
<li>Added Item and Armor weapon kits to NPC presets.</li>
<li>Randomized the default weapon kits of some classes.</li>
<li>Updated ability filter settings to reflect v3.</li>
<li>Steal added to Thief and Trickster as a class art.</li>
<li>Added the ability to define file local calculator templates.</li>
<li>Numerous small bug fixes and corrections</li>
</ul>
<h3>Version 3.0.0</h3>
<h4>General</h4>
<ul>
<li>Changed Create &gt; Weapons &amp; Spells to Create &gt; Inventory</li>
<li>Cha in its old capacity has been changed to Lck (this may break things)</li>
<li>Cha now has a new existance as the greater of Dex and Lck</li>
<li>Old Assign &gt; Levels has been replaced with a persistant Point Buy UI</li>
<li>Point Buy was removed from Tools &gt; Point Buy which is Tools &gt; NPCs now</li>
<li>Should have all v3 content up to level 5 except some Reason arts</li>
</ul>
<h4>Battalions</h4>
<ul>
<li>Added new Create &gt; Battalions tab</li>
<li>Added battalion macro generator to Tools &gt; Macros</li>
</ul>
<h3>Other Stuff</h3>
<ul>
<li>Added new Martyr phantom type</li>
<li>Added classes for all supported phantom types</li>
<li>Added special phantom kits to the NPC generator</li>
<li>Fixed issue where batch macro generation ignored class arts</li>
<li>Depricated old &quot;Phantom&quot; Class</li>
<li>Depricated content now has its own hide toggle</li>
<li>Updated class select to filter by skill requirements.</li>
</ul>
<h3>Version 2.3.2</h3>
<ul>
<li>Fixed a bug where chance based abilities wouldn&#39;t generate macros</li>
</ul>
<h3>Version 2.3.1</h3>
<ul>
<li>Fixed a bug where requirements for certain arts were broken</li>
</ul>
<h3>Version 2.3.0</h3>
<h4>General</h4>
<ul>
<li>Added some features from Patch #6 and Patch #Battalion</li>
<li>Added support for depricating old content</li>
</ul>
<h4>Skills</h4>
<ul>
<li>Made Brawl skill visible again</li>
<li>Skill aptitude (Talent, Weakness, Budding) can now be set per skill</li>
</ul>
<h4>Point Buy</h4>
<ul>
<li>Rebalanced point buy to minimize the effects of growths</li>
<li>Growths underline when they hit a diminished return threshold</li>
<li>Final stat preview underlines when a change increases a stat</li>
<li>Levelup preview now lets you adjust the number of levels from a class</li>
<li>Levelup preview now shows a tooltip containing a summary of the class</li>
<li>Final stats from the preview can be copied directly to the main sheet</li>
</ul>
<h4>NPC Generator</h4>
<p>This is an experimental feature to make it faster to generate generic NPC and
enemy units. Simply pick a class, general build, a main weapon, a side weapon,
and a level, and the builder will set you up with a combat ready unit that
meets those specifications. For the sake of simplicity, setting the class also
sets these other values to recommended defaults, if you want to go even faster.</p>
<p>Generated units are balanced using the point buy demo for Patch #6.</p>
<h4>Weapon Customization</h4>
<ul>
<li>Weapon preview now shows accurate stats and lists attributes</li>
<li>Added the ability to give weapons custom descriptions with rich text</li>
<li>Added the ability to give weapons tags that affect macro generation</li>
<li>Added templates for completely custom weapons</li>
</ul>
<h4>Macro Builder</h4>
<ul>
<li>Macros now display TP and SP costs of actions</li>
<li>Macros now display the thresholds to double/be doubled instead of speed</li>
<li>Macros for tactical arts are really easy to generate now</li>
<li>Macros for all equipped weapons/arts can be batch generated (experimental)</li>
</ul>
<h3>Version 2.2.0</h3>
<ul>
<li>Minor balance adjustments and corrections to character features</li>
<li>Rebalanced the weighting of point buy demo to simplify</li>
<li>Added character stat preview to point buy</li>
</ul>
<h3>Version 2.1.2</h3>
<ul>
<li>Added missing War Mage Gem equipment</li>
<li>Fixed description for Violent Gust</li>
<li>Fixed description for Telekinesis</li>
<li>Fixed Abraxas max range (reduced from 3 to 2)</li>
</ul>
<h3>Version 2.1.1</h3>
<ul>
<li>Changed how Phase interacts with some player created tiles</li>
<li>Added custom weapon templates for each weapon type</li>
<li>Various small game data corrections</li>
<li>Attributes now sorted alphabetically and can filter by weapon/spell</li>
</ul>
<h3>Version 2.1.0</h3>
<p>This started out a fixing a few small bugs in version 2.0.0 but then I decided 
to make some improvements to small things I felt that where lacking, so eh...</p>
<h4>Changes</h4>
<ul>
<li>Added titles to tooltips</li>
<li>Changed sorcerer to be generic to the three magic types</li>
<li>Added text to some classes specifying which class skills are choices</li>
<li>Added &quot;||&quot; delimiter to allow for more than one description per tooltip</li>
<li>Added &quot;cat&quot; keyword to allow string concatenation in the calculator</li>
<li>Added new Golden Egg, Golden Fear, and Document themes</li>
<li>Can specify custom requirements with the &quot;Permission&quot; keyword</li>
<li>Changed Tools &gt; Themes tab to Tools &gt; Configure</li>
<li>Added autosave configuration</li>
<li>Turned the checkboxes into funny buttons because I could.</li>
<li>The Hide buttons now say Show when text is hidden</li>
<li>Finished adding Blurb feature (It generates Markdown)</li>
</ul>
<h4>Bug Fixes</h4>
<ul>
<li>Minor tweaks to a number of weapons/arts/equipment/etc...</li>
<li>Fixed bug where skill validation was always failing</li>
<li>Fixed bug where macros didn&#39;t generate descriptions</li>
<li>Fixed bug where custom weapon might type wasn&#39;t saved</li>
<li>Fixed bug where budding talent would compute wrong on loading a value</li>
<li>Class requirement &quot;pass&quot; indicator updates with skill points</li>
<li>Added missing Tactical Art: Opening</li>
<li>Added missing Tactical Art: Battle Frenzy</li>
<li>Added missing Guile Metamagic: Special</li>
<li>Re-enabled autosave every five minutes (was off for development)</li>
</ul>
<h3>Version 2.0.0</h3>
<p>Version 2.0.0 was a complete overhaul to almost the entire program, and as such
version 1.19.1 character sheets and earlier are not fully compatible with it. I 
appologize for any inconvenience this causes.</p>
<h4>Added</h4>
<ul>
<li>Prominently displayed version number</li>
<li>Prominently displayed link to github/changelog</li>
<li>Automatic reclass requirement check</li>
<li>Ability to export Version 1 autosave data</li>
<li>Manual save button to supplement autosave</li>
<li>Ability to duplicate character sheets</li>
<li>A display for reclass eligability</li>
<li>Character templates for enemy generation (in progress)</li>
<li>Maximum TP and SP calculations</li>
<li>Level up tracker and editor</li>
<li>Glossary of standard status conditions</li>
<li>Glossary of standard tile types</li>
<li>Lots and lots of tooltips</li>
</ul>
<h4>Removed</h4>
<ul>
<li>Dependancy on jinja2</li>
<li>Character name from generated macros, making them generic</li>
<li>Old critical hit calculation (newcrit is now just crit)</li>
<li>Clear character button (now just make new character)</li>
<li>Known Abilities and CombatArts (now just equip them)</li>
<li>Class Mastery options</li>
<li>Health bar</li>
<li>Homeland</li>
</ul>
<h4>Changed</h4>
<ul>
<li>Rearranged tabs to be on the side rather than the bottom</li>
<li>Removed known abilities and arts to reflect new progression system</li>
<li>Added arts from class tab for classes that grant arts</li>
<li>Formulas for dynamic values are now shown</li>
<li>Weapon, equipment, and attribute prices are now displayed</li>
</ul>
<h4>Weapons</h4>
<ul>
<li>Weapons &amp; Spells can now be import and exported</li>
<li>Custom Weapons &amp; Spells can now be customized with Attributes</li>
</ul>
<h4>Calculator</h4>
<ul>
<li>Added &quot;ask&quot; keyword to generate prompts</li>
<li>Added &quot;more&quot; and &quot;less&quot; expressions for min and max</li>
<li>Added &quot;metaif&quot; keyword for conditional compilation</li>
<li>Added &quot;elseif&quot; keyword for easier chaining of conditionals</li>
<li>Added &quot;%&quot; binary operator for modulus</li>
<li>Added &quot;die&quot; binary operator to allow for die rolls</li>
<li>Added &quot;not()&quot; operator for easier conditionals</li>
<li>Added &quot;sign()&quot; operator to get sign of number</li>
<li>Added &quot;meta()&quot; operator for compile time computation</li>
<li>Added alias names for Roll20 variables</li>
<li>Added templates and &quot;fill&quot; keyword so your macros can now have macros</li>
<li>Added variable suggestions</li>
<li>Added syntax and variable explanations</li>
<li>Added syntax highlighting</li>
</ul>
<h4>To Do</h4>
<ul>
<li>Refactor to remove magic element ids</li>
<li>Fix blurb feature which is now broken</li>
<li>Make it possible to select two arts for metamagic (low priority)</li>
<li>Add character templates</li>
<li>Add battalions</li>
</ul>
<h3>Version 1.19.1</h3>
<h4>Bugfixes</h4>
<ul>
<li>Macro builder did not account for hit, crit, etc... boosts from equipment</li>
</ul>
<h3>Version 1.19.0</h3>
<h4>General</h4>
<ul>
<li>Added in new critical hit and critical avoid to computed stats</li>
</ul>
<h4>Macro Generation</h4>
<ul>
<li>Macro design was changed to be more compact</li>
<li>Add in Prompt generation for the Battlefield ability type</li>
<li>Some abilities were changed from Passive to Prompt</li>
<li>Add in some help text to explain how to use the macro tool</li>
<li>Added a link to a document on how the macro console works</li>
</ul>
<h4>Point Buy</h4>
<ul>
<li>Added in an experimental point buy calculator for character creation</li>
<li>Stats from point buy tab can be copied to the main sheet with a button</li>
</ul>
<h4>Misc</h4>
<ul>
<li>Added in new abilities and combat arts for Armor, Riding, and Flying</li>
<li>Added in more powerful ranged swords (knives)</li>
<li>Added Wanderer class</li>
<li>Various other small new content I forgot</li>
</ul>
<h3>Version 1.18.0</h3>
<h4>Themes</h4>
<ul>
<li>Added the ability to change the UI theme of the builder</li>
<li>Old default appearance has become the &quot;Classic&quot; theme</li>
<li>Added the &quot;Dark&quot;, &quot;Golden Deer&quot;, and &quot;Boneless&quot; themes</li>
</ul>
<h4>Autosave</h4>
<ul>
<li>The builder now saves your progress to the browser every five minutes</li>
<li>I added this feature because roll20 crashes my browser a lot</li>
</ul>
<h3>Version 1.17.0</h3>
<h4>Skill System</h4>
<ul>
<li>Modified skill grade thresholds to suit new values</li>
<li>Added Talent, Weakness, and Budding Talent options</li>
<li>Skills now track total number of points</li>
</ul>
<h4>Weapons</h4>
<ul>
<li>Added more of the missing weapons from the base game</li>
<li>Made some previously hidden options visible again</li>
<li>Added O.B.R.&#39;s Homebrew spells to the list</li>
</ul>
<h4>Misc</h4>
<ul>
<li>Overhauled the stat calculation system</li>
<li>Dynamic values for combat arts and spells now display correctly</li>
<li>Macros now show Def, Res, and Spd when attacking</li>
<li>Moved macro builder into a different tab</li>
<li>Added tiny calculator console into the macro tab</li>
</ul>
<h4>Bugfixes</h4>
<ul>
<li>Fixed bug where Reason Prowess was not added to Anima Magic macros</li>
<li>Fixed bug where active weapon persisted invisibly when changing character</li>
</ul>
<h3>Version 1.16.0</h3>
<ul>
<li>Class mastery abilities can be automatically added with the &quot;Master&quot; button</li>
<li>Added a field to the sheet to keep track of gold pieces</li>
<li>Added Monster Hunter and Knight Captain classes</li>
<li>Tweaked Cleric and Thief classes</li>
<li>Fixed bug where stats, growth, and skills would stay when changing character</li>
</ul>
<h3>Version 1.15.0</h3>
<ul>
<li>New tab based user inferface for features (Abilities, Combat Arts, etc...) </li>
<li>Added in the remaining spells that were missing</li>
<li>Added in Killer weapons</li>
</ul>
<h3>Version 1.14.0</h3>
<ul>
<li>Added the ability to import and edit multiple sheets at once</li>
<li>Added the ability to create new blank sheets without reloading the webpage</li>
<li>New character sheet format saves version number and active features</li>
<li>Old format can still be imported</li>
</ul>
<h3>Version 1.13.0</h3>
<ul>
<li>Brawl skill removed from main page; Brawl abilities removed from drop down</li>
<li>Added new spells, abilties, and weapons</li>
</ul>
